{% extends 'base.html' %}
{% load static i18n %}

{% block title %}{{ product.name }} - Fuar Promet{% endblock %}

{% block breadcrumbs %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb container my-3">
        <li class="breadcrumb-item">
            <a href="{% url 'home' %}">{% trans "Home" %}</a>
        </li>

        <li class="breadcrumb-item">
            <a href="{% url 'products' %}">{% trans "Products" %}</a>
        </li>

        <li class="breadcrumb-item">
            <a href="{% url 'category_products' product.category.id %}">
                {{ product.category.name }}
            </a>
        </li>

        <li class="breadcrumb-item active" aria-current="page">
            {{ product.name }}
        </li>
    </ol>
</nav>
{% endblock %}


{% block content %}
<div class="container my-5 py-4 product-detail-page">

    <div class="row align-items-start g-5">

        <!-- PRODUCT IMAGE -->
        <div class="col-lg-6">
           <div class="product-gallery">
            <div class="gallery-image-wrapper">

                {% if product.image %}
                    <img src="{{ product.image.url }}"
                         class="product-detail-img gallery-img active">
                {% endif %}

                {% for img in product.images.all %}
                    <img src="{{ img.image.url }}"
                         class="product-detail-img gallery-img">
                {% endfor %}

                <button class="gallery-btn prev" aria-label="Previous image">
                    <svg viewBox="0 0 24 24">
                        <path d="M15 18l-6-6 6-6"/>
                    </svg>
                </button>

                <button class="gallery-btn next" aria-label="Next image">
                    <svg viewBox="0 0 24 24">
                        <path d="M9 6l6 6-6 6"/>
                    </svg>
                </button>


            </div>
        </div>


        </div>

        <!-- PRODUCT INFO -->
        <div class="col-lg-6">

            <!-- Breadcrumb / Category -->
            <p class="text-muted small mb-2">
                {{ product.category.name }}
            </p>

            <!-- Title -->
            <h1 class="product-title mb-3">
                {{ product.name }}
            </h1>

            <!-- Price -->
            <div class="product-price mb-4">
                {{ product.price }} <span>MKD</span>
            </div>

            <!-- Stock -->
            {% if product.stock > 0 %}
                <span class="stock-badge in-stock">
                    {% trans "In Stock" %}
                </span>
            {% else %}
                <span class="stock-badge out-of-stock">
                    {% trans "Out of Stock" %}
                </span>
            {% endif %}

            <!-- Description -->
            {% if product.description %}
            <div class="product-description mt-4">
                <p>{{ product.description }}</p>
            </div>
            {% endif %}

            <!-- Divider -->
            <hr class="my-4">

            <!-- Specifications -->
            <div class="product-specs">
                <div>
                    <span>{% trans "Code" %}</span>
                    <strong>{{ product.code }}</strong>
                </div>

                <div>
                    <span>{% trans "Dimensions" %}</span>
                    <strong>
                        {{ product.length }} × {{ product.width }} × {{ product.thickness }} mm
                    </strong>
                </div>
            </div>

            <!-- Back Button -->
            <a href="{% url 'products' %}" class="btn btn-outline-dark rounded-pill mt-5 px-4">
                ← {% trans "Back to Products" %}
            </a>

        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", () => {
    const images = document.querySelectorAll(".gallery-img");
    const next = document.querySelector(".gallery-btn.next");
    const prev = document.querySelector(".gallery-btn.prev");

    let index = 0;

    function showImage(i) {
        images.forEach(img => img.classList.remove("active"));
        images[i].classList.add("active");
    }

    next.addEventListener("click", () => {
        index = (index + 1) % images.length;
        showImage(index);
    });

    prev.addEventListener("click", () => {
        index = (index - 1 + images.length) % images.length;
        showImage(index);
    });
});
</script>
{% endblock %}
