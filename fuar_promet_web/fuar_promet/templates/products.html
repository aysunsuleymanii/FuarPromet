{% extends 'base.html' %}
{% load static i18n %}

{% block title %}Products - Fuar Promet{% endblock %}

{% block content %}
<div class="container my-5 py-3">
    <header class="text-center mb-5 pb-3 border-bottom">
        <h1 class="display-4 fw-light text-dark" style="font-weight:400;">{% trans "Explore our carefully selected range of high-quality products." %}</h1>
    </header>

    <!-- Categories on top -->
    <div class="mb-5 d-flex flex-wrap justify-content-center gap-3 category-container">
        <a href="#" class="category-btn active" data-category="all">{% trans "All" %}</a>
        {% for category in categories %}
        <a href="#" class="category-btn" data-category="{{ category.id }}">{{ category.name }}</a>
        {% endfor %}
    </div>

    <div class="row g-4">
        {% for product in products %}
        <div class="col-xl-4 col-lg-6 col-md-6 col-sm-12 product-item" data-category="{{ product.category.id }}">
            <a href="{% url 'product_detail' product.pk %}" class="text-decoration-none text-dark">
                <div class="card h-100 product-card shadow-sm border-0 rounded-3 overflow-hidden">

                    <div class="product-image-container">
                        {% if product.image %}
                        <img src="{{ product.image.url }}" class="card-img-top product-img" alt="{{ product.name }}">
                        {% else %}
                        <img src="{% static 'placeholder-elegant.png' %}" class="card-img-top product-img"
                             alt="No image">
                        {% endif %}
                    </div>

                    <div class="card-body d-flex flex-column p-4">
                        <h5 class="card-title mb-2 text-truncate">{{ product.name }}</h5>

                        <div class="text-secondary small mb-3 product-details">
                            <span class="d-block"><strong>{% trans "Category" %}</strong>: {{ product.category.name }}</span>
                            <span class="d-block"><strong>{% trans "Dimensions" %}</strong>: {{ product.width }} x {{ product.height }} x {{ product.depth }}</span>
                            <span class="d-block"><strong>{% trans "Color" %}</strong>: {{ product.color }}</span>
                        </div>

                        <div class="d-flex justify-content-between align-items-center mb-4 mt-auto pt-2 border-top">
                            <p class="h4 fw-bold text-dark mb-0 product-price">{{ product.price }} MKD</p>

                            {% if product.stock > 0 %}
                            <span class="badge rounded-pill bg-success-subtle text-success py-2 px-3 product-stock-badge">{% trans "In Stock" %}</span>
                            {% else %}
                            <span class="badge rounded-pill bg-danger-subtle text-danger py-2 px-3 product-stock-badge">{% trans "Out of Stock" %}</span>
                            {% endif %}
                        </div>

                    </div>
                </div>
            </a>
        </div>
        {% endfor %}
    </div>

</div>
</div>

<script>
    const categoryButtons = document.querySelectorAll('.category-btn');
    const productItems = document.querySelectorAll('.product-item');

    categoryButtons.forEach(btn => {
        btn.addEventListener('click', e => {
            e.preventDefault();

            // Remove active class from all buttons
            categoryButtons.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            const category = btn.dataset.category;

            productItems.forEach(item => {
                if(category === 'all' || item.dataset.category === category){
                    item.style.display = '';
                } else {
                    item.style.display = 'none';
                }
            });
        });
    });
</script>
{% endblock %}